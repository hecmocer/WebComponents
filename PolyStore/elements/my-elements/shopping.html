<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="shoppingItem.html">

<dom-module id="my-shopping">
    <template>
        <style include="shared-styles">
            .dialog{
                padding: 25px;
            }
            .scrollable-dialog{
                max-height: 500px;
                margin-top: 20px;
            }
            .total{
                border-bottom: black solid 2px;
            }
        </style>

        <div class="dialog">
            <h2>Carrito de compra</h2> saldo: {{saldo}}
            <paper-dialog-scrollable class="scrollable-dialog">
                <div class="total">Total: <strong>{{total}}</strong>â‚¬</div>
                <div id="items"></div>
                Pagar <paper-icon-button icon="next-week" on-click="checkout"></paper-icon-button>
            </paper-dialog-scrollable>
        </div>

    </template>

    <script>
        (function() {
            Polymer({
                is: 'my-shopping',

                properties: {
                    elementos: {
                        type: String,
                        value: "prueba"
                    },
                    total: {
                        type: Number,
                        value: 0
                    },
                    saldo: {
                        type: Number,
                        value: 0
                    }
                },
                addShoppingItem: function(shoppingItem){
                    var items = this.querySelector('#items');
                    var hijos = items.children;

                    for(var i = 0; i < hijos.length; i++){
                        if(hijos[i].name === shoppingItem.name){
                            this.total -= (hijos[i].price * hijos[i].amount);
                            items.removeChild(items.childNodes[i])
                            i = 0;
                        }
                    }

                    items.appendChild(shoppingItem);
                    this.total += (shoppingItem.price * shoppingItem.amount);
                },
                checkout: function(){
                    var items = this.querySelector('#items');
                    var hijos = items.children;

                    for(var i = 0; i < hijos.length; i++){
                        items.removeChild(items.childNodes[i])
                        i = 0;
                    }
                    this.saldo -= this.total;
                    this.total = 0;
                }
            });
        })();
    </script>

</dom-module>